<!-- Import p5.js from CDN-->
<script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.7.0/p5.min.js"> </script>

<script>

    const colors = [
        [255, 0, 0],
        [0, 255, 0],
        [0, 0, 255],
        [255, 255, 0],
        [0, 255, 255],
        [255, 0, 255],
        [255, 255, 255],
        [0, 0, 0],
    ]

    const SCALE =  20 
    
    const socket = new WebSocket('ws://localhost:42000');
    let players = [];

    socket.addEventListener('open', function (event) {

    });

    socket.addEventListener("message", (event) => {
        // console.log(event.data);
        console.time("parse");
        players = JSON.parse(event.data);
        console.timeEnd("parse"); 
    });

    function setup() {
        
        createCanvas(20 * SCALE, 20 * SCALE);

    }
    
    function draw() {
        background(51);

        scale(SCALE)

        rectMode(CENTER)
        try {
            

            for (let player of players.players) {
                fill(colors[player.id % colors.length]);

                noStroke()
                rect(player.p[0], player.p[1], 1 , 0.5 );
            }
        } catch (err) {
            console.error("Rendering error", err);
        }
    

    }


</script>
